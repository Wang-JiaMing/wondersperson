<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4"
      lang="zh-CN">
<head th:include="include/head"></head>
<body style="background-color: whitesmoke">
<div style="height: 150px"></div>

<div class="container">
    <h1 align="center"></h1>
    <div style="height:50px;"></div>
    <div class="row">
        <div class="col-md-12" align="center">
            <div class="panel panel-default" style="width: 500px">
                <div class="panel-heading"><h2>Personnel System Mini-v1.0</h2></div>
                <div class="panel-body">
                    <div class="starter-template">
                        <form name="form" th:action="@{/login}" method="post">
                            <div class="row">
                                <div class="col-md-12" align="center">
                                    <div class="input-group">
                                        <span class="input-group-addon" id="username-span">邮箱</span>
                                        <input type="text" id="username" class="form-control" name="username" value=""/>
                                        <span class="input-group-addon">@wondersgroup.com</span>
                                    </div>
                                </div>
                            </div>
                            <div style="height: 10px"></div>
                            <div class="row">
                                <div class="col-md-12" align="center">
                                    <div class="input-group">
                                        <span class="input-group-addon" id="password-span">密码</span>
                                        <input type="password" id="password" class="form-control" name="password"
                                               value=""/>
                                    </div>
                                </div>
                            </div>
                            <div style="height: 10px"></div>
                            <div class="btn-group" role="group">
                                <button type="submit" class="btn btn-primary">登 录</button>
                                <button type="button" id="register-btn" data-toggle="modal" data-target="#register"
                                        class="btn btn-info">快速注册
                                </button>

                            </div>
                            <button type="button" id="logList" data-toggle="modal" data-target="#log" class="btn btn-default">版本日志
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12" align="center"  >

                <div style="width: 500px" class="alert alert-danger" th:if="${param.error}" role="alert">登陆错误，请检查账号密码后再重试！</div>

            </div>
        </div>
    </div>


</div>


<div class="modal fade" id="register" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="myModalLabel">人员注册</h4>
            </div>
            <div class="modal-body">
                <form id="rgForm">
                    <div class="row">
                        <div class="col-md-12" align="center">
                            <div class="input-group">
                                <span class="input-group-addon" id="rg-username-span">邮箱 <span
                                        style="color: red">*</span></span>
                                <input type="text" id="rg-username" class="form-control" name="username" value=""/>
                                <span class="input-group-addon" id="rg-@">@wondersgroup.com</span>
                            </div>
                        </div>
                    </div>
                    <div style="height: 10px"></div>
                    <div class="row">
                        <div class="col-md-12" align="center">
                            <div class="input-group">
                                <span class="input-group-addon" id="rg-userno-span">工号 <span style="color: red">*</span></span>
                                <input type="text" id="rg-userno" class="form-control" name="userno" value=""/>
                            </div>
                        </div>
                    </div>
                    <div style="height: 10px"></div>
                    <div class="row">
                        <div class="col-md-12" align="center">
                            <div class="input-group">
                                <span class="input-group-addon" id="rg-name-span">姓名 <span
                                        style="color: red">*</span></span>
                                <input type="text" id="rg-name" class="form-control" name="name" value=""/>
                            </div>
                        </div>
                    </div>
                    <div style="height: 10px"></div>
                    <div class="row">
                        <div class="col-md-12" align="center">
                            <div class="input-group">
                                <span class="input-group-addon" id="rg-password-span">密码 <span
                                        style="color: red">*</span></span>
                                <input type="password" id="rg-password" class="form-control" name="password"
                                       value=""/>
                            </div>
                        </div>
                    </div>

                    <div style="height: 10px"></div>
                    <div class="row">
                        <div class="col-md-12" align="center">
                            <div class="input-group">
                                <span class="input-group-addon" id="rg-r-password-span">重复密码 <span
                                        style="color: red">*</span></span>
                                <input type="password" id="rg-r-password" class="form-control" value=""/>
                            </div>
                        </div>
                    </div>

                    <div class="modal-footer">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                        <button type="button" id="rgBtn" class="btn btn-primary">注 册</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>



<div class="modal fade" id="log" tabindex="-1" role="dialog" aria-labelledby="myModalLabel-log">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="myModalLabel-log">版本日志</h4>
            </div>
            <div class="modal-body">
                <div class="panel panel-default">
                    <div class="panel-heading">V1.0</div>
                    <div class="panel-body">
                        <div class="alert alert-success" role="alert">
                            <ul>
                                <li>优化排版方式</li>
                                <li>网络分享URL不再限制http外的协议</li>
                                <li>首页增加个人签到概览</li>
                            </ul>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>

    function registerCheck() {
        var username = $('#rg-username').val();
        var userno = $('#rg-userno').val();
        var password = $('#rg-password').val();
        var rpassword = $('#rg-r-password').val();
        var name = $('#rg-name').val();
        if (username == '' || userno == '' || password == '' || rpassword == '' || name == '') {
            alert('错误：必填项不能为空');
            return;
        }
        if (password != rpassword) {
            alert('错误：两次密码输入不一致');
            return;
        }
        return true;

    }

    $(function () {
        $('#rgBtn').click(function () {
            if (registerCheck()) {
                $.ajax({
                    type: "POST",
                    url: "/user/register",
                    data: $('#rgForm').serialize(),
                    success: function (data) {
                        if (data.type == true) {
                            $('#register').modal('hide');
                            $('#rgForm')[0].reset();
                            alert("注册成功");
                        } else {
                            alert("错误：" + data.msg);
                        }
                    }
                });
            }
        });
    });
</script>
</body>
</html>